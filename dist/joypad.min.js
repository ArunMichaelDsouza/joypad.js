/*	
    joypad.js v2.3.5	
    Copyright (c) 2019 Arun Michael Dsouza (amdsouza92@gmail.com)	
    Licence: MIT	
*/
var a={events:{},publish:function a(b,c){if(this.events.hasOwnProperty(b))this.events[b].forEach(function(a){return a(c)})},subscribe:function a(b,c){if(!this.events.hasOwnProperty(b))this.events[b]=[];this.events[b].push(c);return{unsubscribe:(function(){var a=this.events[b].indexOf(c);if(-1!==a)this.events[b].splice(a,1)}).bind(this)}}};var a1={CONNECT:{NATIVE:"gamepadconnected",ALIAS:"connect"},DISCONNECT:{NATIVE:"gamepaddisconnected",ALIAS:"disconnect"},BUTTON_PRESS:{NATIVE:null,ALIAS:"button_press"},BUTTON_RELEASE:{NATIVE:null,ALIAS:"button_release"},AXIS_MOVEMENT:{NATIVE:null,ALIAS:"axis_move"}};var b={LEFT:{NAME:"left_stick",AXES:{X:0,Y:1}},RIGHT:{NAME:"right_stick",AXES:{X:2,Y:3}}};var c={LEFT:"left",RIGHT:"right",TOP:"top",BOTTOM:"bottom"};var d={button_0:0,button_1:1,button_2:2,button_3:3,button_4:4,button_5:5,button_6:6,button_7:7,button_8:8,button_9:9,button_10:10,button_11:11,button_12:12,button_13:13,button_14:14,button_15:15,button_16:16,button_17:17};var e=.8;var a2=function(a){if(console.warn&&"function"==typeof console.warn)console.warn(a);else console.log(a)};var b1=function(a,b){var c=[];Object.keys(b).forEach(function(d){if(b[d]===a)c.push(d);else if(Array.isArray(b[d])&& -1!==b[d].indexOf(a))c.push(d)});return c};var c1=function(a){return!!a&&!!a.type&&!!a.playEffect&&"function"==typeof a.playEffect||false};var d1=function(){return!!window.navigator.getGamepads&&"function"==typeof window.navigator.getGamepads||false};var f={loopStarted:false,instances:{},buttonEvents:{joypad:[]},settings:{axisMovementThreshold:e},remove:function a(b){return delete this.instances[b]},on:function c(d,e){switch(d){case a1.CONNECT.ALIAS:return a.subscribe(a1.CONNECT.ALIAS,e);case a1.DISCONNECT.ALIAS:return a.subscribe(a1.DISCONNECT.ALIAS,e);case a1.BUTTON_PRESS.ALIAS:return a.subscribe(a1.BUTTON_PRESS.ALIAS,e);case a1.BUTTON_RELEASE.ALIAS:return a.subscribe(a1.BUTTON_RELEASE.ALIAS,e);case a1.AXIS_MOVEMENT.ALIAS:return a.subscribe(a1.AXIS_MOVEMENT.ALIAS,e)}},vibrate:function a(b,c){var f=b.vibrationActuator;var g=c||this.settings.vibration;if(c1(f)){var h=f.type;return b.vibrationActuator.playEffect(h,g)}a2("No vibration actuator interface found - https://developer.mozilla.org/en-US/docs/Web/API/GamepadHapticActuator")},set:function a(b){var c=b.axisMovementThreshold,d=b.vibration,e=b.customButtonMapping;var f=parseFloat(c);if(!isNaN(f))this.settings.axisMovementThreshold=f;this.settings.vibration=d;this.settings.customButtonMapping=e},trigger:function b(c,d){return a.publish(c,d)}};var j=function(a){a.buttons.forEach(function(c,d1){var e=f.settings.customButtonMapping;var f1=e||d;var i=b1(d1,f1);var j=f.buttonEvents;if(i&&i.length)i.forEach(function(b){if(c.pressed){if(!j.joypad[a.index][b])j.joypad[a.index][b]={pressed:true,hold:false,released:false};j.joypad[a.index][b].button=c;j.joypad[a.index][b].index=d1;j.joypad[a.index][b].gamepad=a}else if(!c.pressed&&j.joypad[a.index][b]){j.joypad[a.index][b].released=true;j.joypad[a.index][b].hold=false}})})};var k=function(a){var c1=function(a){return new CustomEvent(a1.AXIS_MOVEMENT.ALIAS,{detail:a})};var g=f.settings.axisMovementThreshold;var h=a.axes;var i=h.length;var j=i/2;h.forEach(function(b1,d){if(Math.abs(b1)>g){var h=null;var i=null;var k=b1;h=d<j?b.LEFT.NAME:b.RIGHT.NAME;if(d===b.LEFT.AXES.X||d===b.RIGHT.AXES.X)i=b1<0?c.LEFT:c.RIGHT;if(d===b.LEFT.AXES.Y||d===b.RIGHT.AXES.Y)i=b1<0?c.TOP:c.BOTTOM;var l={gamepad:a,totalSticks:j,stickMoved:h,directionOfMovement:i,axisMovementValue:k,axis:d};return window.dispatchEvent(c1(l))}})};var m=function(a,b){if(b[a].pressed){l(a1.BUTTON_PRESS.ALIAS,b,a);b[a].pressed=false;b[a].hold=true;b[a].last_event=a1.BUTTON_PRESS.ALIAS}else if(b[a].hold);else if(b[a].released&&b[a].last_event===a1.BUTTON_PRESS.ALIAS){l(a1.BUTTON_RELEASE.ALIAS,b,a);delete b[a]}};var e1={id:null,start:function e(){var f1=window.requestAnimationFrame||window.webkitRequestAnimationFrame;var g=f.buttonEvents;var h=window.navigator.getGamepads();h=Array.prototype.slice.call(h);h.forEach(function(d,e){if(d){if(!g.joypad[e])g.joypad[e]={};f.instances[e]=d;j(d);k(d)}});g.joypad.forEach(function(a){if(a)Object.keys(a).forEach(function(b){m(b,a)})});this.id=f1(this.start.bind(this))},stop:function a(b){var c=window.cancelAnimationFrame||window.webkitCancelAnimationFrame;return c(b)}};var i=function(){window.addEventListener(a1.CONNECT.NATIVE,function(e){a.publish(a1.CONNECT.ALIAS,e);if(!f.loopStarted){f.loopStarted=true;return e1.start()}});window.addEventListener(a1.DISCONNECT.NATIVE,function(e){a.publish(a1.DISCONNECT.ALIAS,e);f.remove(e.gamepad.index);f.buttonEvents.joypad[e.gamepad.index]=null;if(!Object.keys(f.instances).length){f.loopStarted=false;return e1.stop(e1.id)}});window.addEventListener(a1.BUTTON_PRESS.ALIAS,function(b){return a.publish(a1.BUTTON_PRESS.ALIAS,b)});window.addEventListener(a1.BUTTON_RELEASE.ALIAS,function(b){return a.publish(a1.BUTTON_RELEASE.ALIAS,b)});window.addEventListener(a1.AXIS_MOVEMENT.ALIAS,function(b){return a.publish(a1.AXIS_MOVEMENT.ALIAS,b)})};var l=function(a,b,c){var d=function(b){return new CustomEvent(a,{detail:b})};var e=b[c],f=e.index,g=e.gamepad;var h={buttonName:c,button:b[c].button,index:f,gamepad:g};window.dispatchEvent(d(h))};i();if(d1())window.joypad=f;else{window.joypad={};a2("Your browser does not support the Gamepad API - https://developer.mozilla.org/en-US/docs/Web/API/Gamepad_API")}